---
title: "Cleaning Dataframe + find linking group housing"
author: "Lucy He"
date: "3/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(readxl)
library(reprex)
library(janitor)
library(gt)
library(shiny)
library(googlesheets4)
```

```{r}
sheets_deauth()
sheet <- read_sheet(ss= "https://docs.google.com/spreadsheets/d/1NQd723ndO2vC6sw7LFBs_I8NZTqJ35EWadwkN8hRZng/edit#gid=1484251186") %>%
  clean_names() %>%
  select(-timestamp,-email_address)
```
```{r clean_names, echo = FALSE}
# clean column_names
names(sheet)[names(sheet) == "ethnicity_check_all_that_apply"]<-"ethinicity"
names(sheet)[names(sheet) == "religion_check_all_that_apply"] <- "religion"
names(sheet)[names(sheet) == "are_you_an_international_student"] <- "international"
names(sheet)[names(sheet) == "are_you_an_international_student"] <- "international"
names(sheet)[names(sheet) == "if_you_answered_yes_to_being_an_international_student_what_country_are_you_from"]<- "country"
names(sheet)[names(sheet) == "if_you_answered_yes_to_being_a_varsity_athlete_what_sport_do_you_play_on"]<- "sport"
names(sheet)[names(sheet) == "are_you_a_varsity_athlete"]<- "varsity"
names(sheet)[names(sheet)=="if_you_answered_yes_to_being_a_legacy_student_what_house_was_your_relative_in"]<- "relative_house"
names(sheet)[names(sheet) == "are_you_on_any_financial_aid"]<- "financial_aid"
names(sheet)[names(sheet) == "what_is_your_blocking_group_size"]<-"group_size"
names(sheet)[names(sheet)=="what_is_your_blocking_group_name_all_lowercase_with_no_spaces"]<- "group_name"
names(sheet)[names(sheet)=="what_is_your_blocking_group_leaders_name_first_and_last_ex_john_doe"]<- "group_leader"
names(sheet)[names(sheet)=="what_house_were_you_placed_in"]<- "house"
names(sheet)[names(sheet)=="if_you_are_linking_please_provide_the_first_and_last_name_of_one_person_from_your_linking_group"] <- "linking_group"
names(sheet)[names(sheet) == "are_you_blocking_with_any_of_your_suitemates"]<- "suitemates"
names(sheet)[names(sheet)=="please_list_all_members_in_your_blocking_group_separated_by_commas_first_and_last_ex_john_doe_john_harvard"]<- "group_members"

sheet
```

```{r locate linking group house, echo =  FALSE}
ppl_from_linked <- sheet %>% select(linking_group)
output <- for (val in ppl_from_linked){
sheet %>%
  filter(str_detect(group_members, val) == TRUE) %>%
  select(house)
}

```

```{r find dorm/entryway that "bonds" best}
sheet %>%
  filter(!is.na(suitemates)) %>%
  group_by(freshman_dorm) %>%
  arrange(desc())

```